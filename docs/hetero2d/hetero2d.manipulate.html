<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>hetero2d.manipulate package &mdash; Hetero2d 1.0.0 documentation</title><link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="hetero2d.workflow package" href="hetero2d.workflow.html" />
    <link rel="prev" title="hetero2d.io package" href="hetero2d.io.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> Hetero2d
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../project_intro/modules.html">Project Introduction</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">Documentation</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="hetero2d.html">hetero2d package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="hetero2d.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="hetero2d.firetasks.html">hetero2d.firetasks package</a></li>
<li class="toctree-l4"><a class="reference internal" href="hetero2d.fireworks.html">hetero2d.fireworks package</a></li>
<li class="toctree-l4"><a class="reference internal" href="hetero2d.io.html">hetero2d.io package</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">hetero2d.manipulate package</a></li>
<li class="toctree-l4"><a class="reference internal" href="hetero2d.workflow.html">hetero2d.workflow package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="hetero2d.html#module-hetero2d">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Hetero2d</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="modules.html">hetero2d</a> &raquo;</li>
          <li><a href="hetero2d.html">hetero2d package</a> &raquo;</li>
      <li>hetero2d.manipulate package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/hetero2d/hetero2d.manipulate.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="hetero2d-manipulate-package">
<h1>hetero2d.manipulate package<a class="headerlink" href="#hetero2d-manipulate-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-hetero2d.manipulate.heterotransmuter">
<span id="hetero2d-manipulate-heterotransmuter-module"></span><h2>hetero2d.manipulate.heterotransmuter module<a class="headerlink" href="#module-hetero2d.manipulate.heterotransmuter" title="Permalink to this headline">¶</a></h2>
<p>These modules are used to create the heterostructure configurations given a 2d and substrate slab.
The code is adopted from the MPInterfaces to ensure the code is compatible with the FireWorks and
atomate architecture, to fix minor bugs in the original code, and return interface matching criteria.</p>
<dl class="py function">
<dt id="hetero2d.manipulate.heterotransmuter.rotate_to_acute">
<code class="sig-prename descclassname">hetero2d.manipulate.heterotransmuter.</code><code class="sig-name descname">rotate_to_acute</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">structure</span></em><span class="sig-paren">)</span><a class="headerlink" href="#hetero2d.manipulate.heterotransmuter.rotate_to_acute" title="Permalink to this definition">¶</a></dt>
<dd><p>If the angle for a 2D structure is obtuse, reflect the b vector to -b to make it acute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>structure</strong> (<em>Structure</em>) – structure to rotate.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>rotated structure</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hetero2d.manipulate.heterotransmuter.aligned_hetero_structures">
<code class="sig-prename descclassname">hetero2d.manipulate.heterotransmuter.</code><code class="sig-name descname">aligned_hetero_structures</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">struct_2d</span></em>, <em class="sig-param"><span class="n">struct_sub</span></em>, <em class="sig-param"><span class="n">max_mismatch</span><span class="o">=</span><span class="default_value">0.01</span></em>, <em class="sig-param"><span class="n">max_area</span><span class="o">=</span><span class="default_value">200</span></em>, <em class="sig-param"><span class="n">nlayers_2d</span><span class="o">=</span><span class="default_value">3</span></em>, <em class="sig-param"><span class="n">nlayers_sub</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="n">r1r2_tol</span><span class="o">=</span><span class="default_value">0.02</span></em>, <em class="sig-param"><span class="n">max_angle_diff</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">separation</span><span class="o">=</span><span class="default_value">3.4</span></em><span class="sig-paren">)</span><a class="headerlink" href="#hetero2d.manipulate.heterotransmuter.aligned_hetero_structures" title="Permalink to this definition">¶</a></dt>
<dd><p>Given the 2 slab structures and the alignment parameters, return
slab structures with lattices that are aligned with respect to each
other.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>slab_2d</strong> (<em>Structure</em>) – Two dimensional slab structure object.</p></li>
<li><p><strong>slab_sub</strong> (<em>Structure</em>) – Substrate slab structure object.</p></li>
<li><p><strong>max_area</strong> (<em>float</em>) – The maximum area you want to search for
a matching lattice. Defaults to 200 sqr. Angstroms.</p></li>
<li><p><strong>max_mismatch</strong> (<em>float</em>) – The maximum mismatch between the a
and b lattice vectors of the aligned 2D and substrate
lattice vectors. Defaults to 0.01, multiply by 100 to
obtain percent.</p></li>
<li><p><strong>max_angle_diff</strong> (<em>float</em>) – The angle deviation between the a and
b lattice vectors between the old lattice vectors and the
new lattice vectors. Defaults to 1 degree.</p></li>
<li><p><strong>r1r2_tol</strong> (<em>float</em>) – Allowed area approximation tolerance for the two
lattices. Defaults to 0.02.</p></li>
<li><p><strong>nlayers_substrate</strong> (<em>int</em>) – number of substrate layers. Defaults
to 2 layers.</p></li>
<li><p><strong>nlayers_2d</strong> (<em>int</em>) – number of 2d material layers. Defaults to
3 layers.</p></li>
<li><p><strong>separation</strong> (<em>float</em>) – separation between the substrate and the 2d
material. Defaults to 3.4 angstroms.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>aligned_sub, aligned_2d, alignment_info</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hetero2d.manipulate.heterotransmuter.generate_all_configs">
<code class="sig-prename descclassname">hetero2d.manipulate.heterotransmuter.</code><code class="sig-name descname">generate_all_configs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mat2d</span></em>, <em class="sig-param"><span class="n">substrate</span></em>, <em class="sig-param"><span class="n">nlayers_2d</span><span class="o">=</span><span class="default_value">3</span></em>, <em class="sig-param"><span class="n">nlayers_substrate</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="n">separation</span><span class="o">=</span><span class="default_value">3.4</span></em><span class="sig-paren">)</span><a class="headerlink" href="#hetero2d.manipulate.heterotransmuter.generate_all_configs" title="Permalink to this definition">¶</a></dt>
<dd><p>For the given lattice matched 2D material and substrate structures, this functions computes all
unique (Wyckoff) sites of the mat2d and substrate. The unique sites are iteratively matched
between the mat2d and substrate stacking the unique sites on top of each other separated by the
separation distance parameter. This subsequently generates all possible 2d/substrate heterostructure
configurations stacked over high symmetry points. All unique structures are returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mat2d</strong> (<em>Structure</em>) – Lattice and symmetry-matched 2D material
structure.</p></li>
<li><p><strong>substrate</strong> (<em>Structure</em>) – Lattice and symmetry-matched 2D
substrate structure.</p></li>
<li><p><strong>nlayers_substrate</strong> (<em>int</em>) – number of substrate layers. Defaults
to 2 layers.</p></li>
<li><p><strong>nlayers_2d</strong> (<em>int</em>) – number of 2d material layers. Defaults to
3 layers.</p></li>
<li><p><strong>separation</strong> (<em>float</em>) – separation between the substrate and the 2d
material. Defaults to 3.4 angstroms.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of hetero_interface configurations</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hetero2d.manipulate.heterotransmuter.hetero_interfaces">
<code class="sig-prename descclassname">hetero2d.manipulate.heterotransmuter.</code><code class="sig-name descname">hetero_interfaces</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">struct_2d</span></em>, <em class="sig-param"><span class="n">struct_sub</span></em>, <em class="sig-param"><span class="n">max_mismatch</span><span class="o">=</span><span class="default_value">0.01</span></em>, <em class="sig-param"><span class="n">max_area</span><span class="o">=</span><span class="default_value">200</span></em>, <em class="sig-param"><span class="n">nlayers_2d</span><span class="o">=</span><span class="default_value">3</span></em>, <em class="sig-param"><span class="n">nlayers_sub</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="n">r1r2_tol</span><span class="o">=</span><span class="default_value">0.02</span></em>, <em class="sig-param"><span class="n">max_angle_diff</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">separation</span><span class="o">=</span><span class="default_value">3.4</span></em><span class="sig-paren">)</span><a class="headerlink" href="#hetero2d.manipulate.heterotransmuter.hetero_interfaces" title="Permalink to this definition">¶</a></dt>
<dd><p>The given the 2D material and the substrate slab, the 2 slabs are
combined to generate all possible unique structures for the
2D material on the substrate surface generating all unique
hetero_structures.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>struct_2d</strong> – The 2-dimensions slab structure to combine with
the substrate slab.</p></li>
<li><p><strong>struct_sub</strong> – The substrate slab structure which the 2D
structure will be placed on top of.</p></li>
<li><p><strong>max_mismatch</strong> (<em>float</em>) – The maximum allowed lattice strain applied
to the struct_2d. Defaults to 0.01, multiply by 100 to obtain
percent strain.</p></li>
<li><p><strong>max_area</strong> (<em>float</em>) – The maximum surface area of the supercell to
search for potential lattice matches between struct_2d and
struct_sub. Typical values 30-200 Angstroms.</p></li>
<li><p><strong>max_angle_diff</strong> (<em>float</em>) – The maximum allowed deviation
between the new superlattice and the old lattice a and b
vectors. Angle between a and b vectors: arccos[a.b/(<a href="#id1"><span class="problematic" id="id2">|a||b|</span></a>)].
Default value 1 degree.</p></li>
<li><p><strong>r1r2_tol</strong> (<em>float</em>) – The maximum allowed deviation between the
scaled surface area of the 2d and substrate. Typical values
range from 0.01 to 0.1.</p></li>
<li><p><strong>nlayers_2d</strong> (<em>int</em>) – The number of layers of the 2D materials
which you want to relax during the relaxation. Defaults
to 3 layers.</p></li>
<li><p><strong>nlayers_sub</strong> (<em>int</em>) – The number of layers of the substrate surface
which you want to relax during the relaxation. Defaults
to 2 layers with bottom layer frozen.</p></li>
<li><p><strong>separation</strong> (<em>float</em>) – Separation distance between struct_sub
and struct_2d. Default 3.4 Angstroms.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Unique hetero_structures list, last entry contains lattice alignment
information. Site properties contain iface name.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hetero2d.manipulate.heterotransmuter.iface_name">
<code class="sig-prename descclassname">hetero2d.manipulate.heterotransmuter.</code><code class="sig-name descname">iface_name</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mat2d</span></em>, <em class="sig-param"><span class="n">substrate</span></em><span class="sig-paren">)</span><a class="headerlink" href="#hetero2d.manipulate.heterotransmuter.iface_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function used to generate a unique interface name for a set of interfaces. The substrate’s name
will always be the same but the 2d materials indices shit and these are changed from one configuration to
the next.</p>
</dd></dl>

<dl class="py function">
<dt id="hetero2d.manipulate.heterotransmuter.remove_duplicates">
<code class="sig-prename descclassname">hetero2d.manipulate.heterotransmuter.</code><code class="sig-name descname">remove_duplicates</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">uv_list</span></em>, <em class="sig-param"><span class="n">tm_list</span></em><span class="sig-paren">)</span><a class="headerlink" href="#hetero2d.manipulate.heterotransmuter.remove_duplicates" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove duplicates based on a, b, alpha matching. Helper function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>uv_list</strong> (<em>list</em>) – the a and b lattice vectors to transform.</p></li>
<li><p><strong>tm_list</strong> (<em>list</em>) – a list of transformation matrices.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>new_uv_list, new_tm_list</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-hetero2d.manipulate.layersolver">
<span id="hetero2d-manipulate-layersolver-module"></span><h2>hetero2d.manipulate.layersolver module<a class="headerlink" href="#module-hetero2d.manipulate.layersolver" title="Permalink to this headline">¶</a></h2>
<p>Analyze an existing structure and parse it based on atomic layers. The cutoff can be
changed but defaults to 0.5 Angstroms. Returns a LayeredStructure dictionary.</p>
<dl class="py function">
<dt id="hetero2d.manipulate.layersolver.LayerSolver">
<code class="sig-prename descclassname">hetero2d.manipulate.layersolver.</code><code class="sig-name descname">LayerSolver</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">structure</span></em>, <em class="sig-param"><span class="n">cutoff</span><span class="o">=</span><span class="default_value">0.5</span></em><span class="sig-paren">)</span><a class="headerlink" href="#hetero2d.manipulate.layersolver.LayerSolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Group sites in a structure into layers according to z-coordinate. Return layer specific data such as the
z-coordinate of layer, a list of sites, the species of elements in the layer and the atom indices of that layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure</strong> (<em>Structure</em>) – Input structure to be analyzed.</p></li>
<li><p><strong>cutoff</strong> (<em>float</em>) – The inter-layer separation distance that the algorithm searches for.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>each layer information is encoded with dictionary key
num_layers (int): number of layers in the structure and Layer{i} with sub-keys
avg_z (float): average z-coordinate of the layer
sites (list of PeriodicSite): PeriodicSites for each site within the layer
species (list): elemental species of each site within the layer
site_idx (list): atom indices for species within the layer
wyckoffs (list): wyckoff symbols for each site in the layer</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Layers dictionary returning layer specific information</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-hetero2d.manipulate.utils">
<span id="hetero2d-manipulate-utils-module"></span><h2>hetero2d.manipulate.utils module<a class="headerlink" href="#module-hetero2d.manipulate.utils" title="Permalink to this headline">¶</a></h2>
<p>Useful utilities to view, analyze, and change structures. Some functions are not intended for
the user.</p>
<dl class="py function">
<dt id="hetero2d.manipulate.utils.get_mongo_client">
<code class="sig-prename descclassname">hetero2d.manipulate.utils.</code><code class="sig-name descname">get_mongo_client</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">db_file</span></em>, <em class="sig-param"><span class="n">db_type</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#hetero2d.manipulate.utils.get_mongo_client" title="Permalink to this definition">¶</a></dt>
<dd><p>Connect to the database using mongoclient. Has multiple
connection modes for URI (the url string) and ATLAS credentials.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>db_file</strong> (<em>str</em>) – The db.json file location.</p></li>
<li><p><strong>db_type</strong> (<em>str</em>) – String describing the type of connection you are
trying to make. Options - ATLAS or URI. For a private MongoDB
server, ignore this tag.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>client, database_name</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hetero2d.manipulate.utils.average_z_sep">
<code class="sig-prename descclassname">hetero2d.manipulate.utils.</code><code class="sig-name descname">average_z_sep</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">structure</span></em>, <em class="sig-param"><span class="n">iface_idx</span></em>, <em class="sig-param"><span class="n">initial</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#hetero2d.manipulate.utils.average_z_sep" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the average z separation distance between 2
layers in a structure. If provided an initial
structure the change in the post-adsorbed z
separation distance is calculated. Typically used
for 2D-substrate heterostructures in AnalysisToDb.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure</strong> (<em>Structure</em>) – the final structure to
analyze.</p></li>
<li><p><strong>iface_idx</strong> (<em>dict</em>) – Dictionary containing a list
of atom indices for each layer. Computed
using tag_iface.</p></li>
</ul>
</dd>
<dt class="field-even">Other Parameters</dt>
<dd class="field-even"><p><strong>initial</strong> (<em>Structure</em>) – the initial structure prior
to DFT optimization.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>z-separation, delta_2d_z</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hetero2d.manipulate.utils.center_slab">
<code class="sig-prename descclassname">hetero2d.manipulate.utils.</code><code class="sig-name descname">center_slab</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">structure</span></em><span class="sig-paren">)</span><a class="headerlink" href="#hetero2d.manipulate.utils.center_slab" title="Permalink to this definition">¶</a></dt>
<dd><p>Centers the atoms in a slab structure around 0.5
fractional height.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>structure</strong> (<em>Structure</em>) – Structure to center.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Centered Structure object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hetero2d.manipulate.utils.get_fu">
<code class="sig-prename descclassname">hetero2d.manipulate.utils.</code><code class="sig-name descname">get_fu</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">struct_sub</span></em>, <em class="sig-param"><span class="n">struct_2d</span></em>, <em class="sig-param"><span class="n">sub_aligned</span></em>, <em class="sig-param"><span class="n">td_aligned</span></em><span class="sig-paren">)</span><a class="headerlink" href="#hetero2d.manipulate.utils.get_fu" title="Permalink to this definition">¶</a></dt>
<dd><p>Given superlattice structures and original unit cell structures
return the number of formula units of the aligned 2d and substrate
based on the original substrate and 2d component structures.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>struct_sub</strong> (<em>Structure</em>) – Unit cell for the substrate structure
to be aligned to another structure.</p></li>
<li><p><strong>struct_2d</strong> (<em>Structure</em>) – Unit cell for the 2d material to be
aligned to the substrate structure.</p></li>
<li><p><strong>aligned_sub</strong> (<em>Structure</em>) – Superlattice for the substrate aligned
to the 2d material.</p></li>
<li><p><strong>aligned_2d</strong> (<em>Structure</em>) – Superlattice for the 2d material aligned
to the substrate structure.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>fu_2d, fu_sub</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hetero2d.manipulate.utils.set_sd_flags">
<code class="sig-prename descclassname">hetero2d.manipulate.utils.</code><code class="sig-name descname">set_sd_flags</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">interface</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">n_layers</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="n">top</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">bottom</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">lattice_dir</span><span class="o">=</span><span class="default_value">2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#hetero2d.manipulate.utils.set_sd_flags" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the relaxation flags for top and bottom layers of interface.</p>
<p>The upper and lower bounds of the z coordinate are determined
based on the slab. All layers above and below the bounds will
be relaxed. This means if there is a ligand on top of the slab,
all of its atoms will also be relaxed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>interface</strong> (<em>Structure</em>) – input structure file.</p></li>
<li><p><strong>n_layers</strong> (<em>int</em>) – number of layers to be relaxed.</p></li>
<li><p><strong>top</strong> (<em>bool</em>) – whether n_layers from top are be relaxed.</p></li>
<li><p><strong>bottom</strong> (<em>bool</em>) – whether n_layers from bottom are be relaxed.</p></li>
<li><p><strong>lattice_dir</strong> (<em>str</em>) – whether to search the a, b, or c axis for
layers.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>sd_flags</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hetero2d.manipulate.utils.get_key">
<code class="sig-prename descclassname">hetero2d.manipulate.utils.</code><code class="sig-name descname">get_key</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">my_dict</span></em>, <em class="sig-param"><span class="n">val</span></em><span class="sig-paren">)</span><a class="headerlink" href="#hetero2d.manipulate.utils.get_key" title="Permalink to this definition">¶</a></dt>
<dd><p>Function returns the key corresponding to a dictionary value.</p>
</dd></dl>

<dl class="py function">
<dt id="hetero2d.manipulate.utils.round_decimals_down">
<code class="sig-prename descclassname">hetero2d.manipulate.utils.</code><code class="sig-name descname">round_decimals_down</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">number</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">decimals</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#hetero2d.manipulate.utils.round_decimals_down" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a value rounded down to a specific number of decimal places.</p>
</dd></dl>

<dl class="py function">
<dt id="hetero2d.manipulate.utils.slab_from_struct">
<code class="sig-prename descclassname">hetero2d.manipulate.utils.</code><code class="sig-name descname">slab_from_struct</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">structure</span></em>, <em class="sig-param"><span class="n">hkl</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#hetero2d.manipulate.utils.slab_from_struct" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads a pymatgen structure object and returns a Slab object. Useful for reading
in 2d/substrate structures from atomate wf’s.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hkl</strong> (<em>list</em>) – miller index of the slab in the input file.</p></li>
<li><p><strong>structure</strong> (<em>Structure</em>) – structure file in any format supported by pymatgen.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Slab structure object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hetero2d.manipulate.utils.struct_from_str">
<code class="sig-prename descclassname">hetero2d.manipulate.utils.</code><code class="sig-name descname">struct_from_str</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">string</span></em><span class="sig-paren">)</span><a class="headerlink" href="#hetero2d.manipulate.utils.struct_from_str" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a string serialized pymatgen structure object, return a structure object.
Fixes a conversion error when j_sanitizing structure objects not in dictionary
format. Probably due to my ignorance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>string</strong> (<em>str</em>) – A string representation of a structure object.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>pymatgen structure object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hetero2d.manipulate.utils.tag_iface">
<code class="sig-prename descclassname">hetero2d.manipulate.utils.</code><code class="sig-name descname">tag_iface</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">structure</span></em>, <em class="sig-param"><span class="n">nlayers_2d</span></em>, <em class="sig-param"><span class="n">nlayers_sub</span><span class="o">=</span><span class="default_value">2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#hetero2d.manipulate.utils.tag_iface" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the atom indices in a heterostructure by specifying how many
layers there are for the 2D material. Returns a dictionary of atom
ids for each layer of the 2D material and nlayers_sub of the
substrate surface.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure</strong> (<em>Structure</em>) – The hetero_interface structure.
Should be an unrelaxed structure.</p></li>
<li><p><strong>nlayers_2d</strong> (<em>int</em>) – The number of layers contained
within the 2d material.</p></li>
<li><p><strong>nalyers_sub</strong> (<em>int</em>) – The number of layers of the substrate
surface to include in the interface tags.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>layer_indices</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hetero2d.manipulate.utils.show_struct_ase">
<code class="sig-prename descclassname">hetero2d.manipulate.utils.</code><code class="sig-name descname">show_struct_ase</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">structure</span></em><span class="sig-paren">)</span><a class="headerlink" href="#hetero2d.manipulate.utils.show_struct_ase" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a pop up structure model for a pymatgen structure object using ase’s
viewer. Created for use in jupyter notebooks and might not work over remote
access.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>structure</strong> (<em>Structure</em>) – Structure to show.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="hetero2d.manipulate.utils.nn_site_indices">
<em class="property">class </em><code class="sig-prename descclassname">hetero2d.manipulate.utils.</code><code class="sig-name descname">nn_site_indices</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">structure</span></em>, <em class="sig-param"><span class="n">NN</span></em>, <em class="sig-param"><span class="n">target_sites</span></em>, <em class="sig-param"><span class="n">cation_anion</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">oxi_states</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">image</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">duplicate</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#hetero2d.manipulate.utils.nn_site_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">pymatgen.analysis.local_env.CrystalNN</span></code></p>
<p>This function returns the nearest neighbor atom id’s for a
given atom id. This function searches from [start,end]
using the NN variable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure</strong> (<em>Structure</em>) – pymatgen structure object to perform
analysis on.</p></li>
<li><p><strong>NN</strong> (<em>list</em>) – A list indicating the radius from [start,end] to
search for valid anions/cations. This is used to set
the search_cutoff which will be given by the end
value.</p></li>
<li><p><strong>target_sites</strong> (<em>[</em><em>int</em><em>]</em>) – A list of atom ids which you want
to search around for NN cations/anions. Atom id’s can be
visualized using ASE.</p></li>
<li><p><strong>cation_anion</strong> (<em>bool</em>) – Whether to match anion and cation pairs.
Defaults to False.</p></li>
<li><p><strong>oxi_states</strong> (<em>dict</em>) – If anion_cation true, provide a dictionary
of the oxidation states for each cation/anion species.</p></li>
<li><p><strong>image</strong> (<em>bool</em>) – Whether to return data from image cells. Defaults
to True.</p></li>
<li><p><strong>duplicated</strong> (<em>bool</em>) – Remove duplicated sites and return only the
unique site_indices for the structure. Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dictionary containing the atom id
which was searched around and the corresponding list
of NN atom ids of the cation/anions.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>site_data (dict)</p>
</dd>
</dl>
<p>Initialize CrystalNN with desired parameters. Default parameters assume
“chemical bond” type behavior is desired. For geometric neighbor
finding (e.g., structural framework), set (i) distance_cutoffs=None,
(ii) x_diff_weight=0.0 and (optionally) (iii) porous_adjustment=False
which will disregard the atomic identities and perform best for a purely
geometric match.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>weighted_cn</strong> – (bool) if set to True, will return fractional weights
for each potential near neighbor.</p></li>
<li><p><strong>cation_anion</strong> – (bool) if set True, will restrict bonding targets to
sites with opposite or zero charge. Requires an oxidation states
on all sites in the structure.</p></li>
<li><p><strong>distance_cutoffs</strong> – ([float, float]) - if not None, penalizes neighbor
distances greater than sum of covalent radii plus
distance_cutoffs[0]. Distances greater than covalent radii sum
plus distance_cutoffs[1] are enforced to have zero weight.</p></li>
<li><p><strong>x_diff_weight</strong> – (float) - if multiple types of neighbor elements are
possible, this sets preferences for targets with higher
electronegativity difference.</p></li>
<li><p><strong>porous_adjustment</strong> – (bool) - if True, readjusts Voronoi weights to
better describe layered / porous structures</p></li>
<li><p><strong>search_cutoff</strong> – (float) cutoff in Angstroms for initial neighbor
search; this will be adjusted if needed internally</p></li>
<li><p><strong>fingerprint_length</strong> – (int) if a fixed_length CN “fingerprint” is
desired from get_nn_data(), set this parameter</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="hetero2d.manipulate.utils.nn_site_indices.avg_site_bond_dist">
<code class="sig-name descname">avg_site_bond_dist</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">bonded_elm</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">return_avg_list</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#hetero2d.manipulate.utils.nn_site_indices.avg_site_bond_dist" title="Permalink to this definition">¶</a></dt>
<dd><p>Give the site-dependent bond distance from the target site.
If return_avg_list is True, an average bond distance is provided
for each target sites nearest neighbor list entry returned
by the all_nn_info method. Bonding distance dictionary returned
with the format {nn_target_site_index: {nn_bonded_atom_index:
bond_distance_value}. Bond distance is computed from the
all_nn_info() method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bonded_elm</strong> (<em>list</em>) – List of elements that you want
to determine bond lengths for. If empty finds
all nearby elements. If empty, all elements are
considered for analysis.</p></li>
<li><p><strong>return_avg_list</strong> (<em>bool</em>) – Whether to return the average
bond distance.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dictionary of NN bond distances for each target specie.
If return_avg_list=True, returns the avg bond distance
of each target specie.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="hetero2d.manipulate.utils.nn_site_indices.image_filter">
<code class="sig-name descname">image_filter</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em><span class="sig-paren">)</span><a class="headerlink" href="#hetero2d.manipulate.utils.nn_site_indices.image_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Filter out all sites that are not bonded within the (0,0,0) unit
cell. Triggered by image = False.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> (<em>dict</em>) – the cNN.all_nninfo data type.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="hetero2d.manipulate.utils.nn_site_indices.remove_duplicates">
<code class="sig-name descname">remove_duplicates</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em><span class="sig-paren">)</span><a class="headerlink" href="#hetero2d.manipulate.utils.nn_site_indices.remove_duplicates" title="Permalink to this definition">¶</a></dt>
<dd><p>Return only the unique site indices from the all_nninfo
cNN returned for each site. Truggered by duplicates=True.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> (<em>dict</em>) – the cNN.all_nninfo data type.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="hetero2d.manipulate.utils.nn_site_indices.all_nn_info">
<code class="sig-name descname">all_nn_info</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#hetero2d.manipulate.utils.nn_site_indices.all_nn_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the get_nn_data attribute from CrystalNN with or
without image data, with options to remove duplicated
site_indices. Example: [{‘site’:’PeriodicSite’,
‘image’:(int,int,int), ‘weight’:float, ‘site_index’:int}, ..]</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>nn_data (dict)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="hetero2d.manipulate.utils.nn_site_indices.site_indices">
<code class="sig-name descname">site_indices</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#hetero2d.manipulate.utils.nn_site_indices.site_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the nearest neighbor site indices subject to the NN search criteria.</p>
</dd></dl>

<dl class="py method">
<dt id="hetero2d.manipulate.utils.nn_site_indices.site_elements">
<code class="sig-name descname">site_elements</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#hetero2d.manipulate.utils.nn_site_indices.site_elements" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the nearest neighbor elements that correspond to the site indices.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="hetero2d.manipulate.utils.iface_layer_locator">
<code class="sig-prename descclassname">hetero2d.manipulate.utils.</code><code class="sig-name descname">iface_layer_locator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">structure</span></em>, <em class="sig-param"><span class="n">cutoff</span></em>, <em class="sig-param"><span class="n">iface_elements</span></em><span class="sig-paren">)</span><a class="headerlink" href="#hetero2d.manipulate.utils.iface_layer_locator" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function used to locate the iface layers from
the layer solver.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure</strong> (<em>Structure</em>) – input structure to find the
interface layers for.</p></li>
<li><p><strong>cutoff</strong> (<em>float</em>) – the layer separation cutoff distance.</p></li>
<li><p><strong>iface_elements</strong> (<em>list</em>) – A list of element species
that compose the top and bottom iface layers.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>LayerSolver object, top_layer specie, bottom_layer specie</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hetero2d.manipulate.utils.atomic_distance">
<code class="sig-prename descclassname">hetero2d.manipulate.utils.</code><code class="sig-name descname">atomic_distance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">structure</span></em>, <em class="sig-param"><span class="n">dist</span><span class="o">=</span><span class="default_value">2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#hetero2d.manipulate.utils.atomic_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a structure and an interatomic separation distance all sites which have a
spacing less than dist will be printed out.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure</strong> (<em>Structure</em>) – The structure to analyze.</p></li>
<li><p><strong>dist</strong> (<em>float</em>) – A cut-off value which defines the minimum inter_atomic spacing.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-hetero2d.manipulate">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-hetero2d.manipulate" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="hetero2d.io.html" class="btn btn-neutral float-left" title="hetero2d.io package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="hetero2d.workflow.html" class="btn btn-neutral float-right" title="hetero2d.workflow package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Tara Maria Boland.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>